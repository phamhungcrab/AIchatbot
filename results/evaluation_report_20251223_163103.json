{
  "evaluation_timestamp": "2025-12-23 16:31:03",
  "summary": {
    "description": "Đánh giá hệ thống AI Chatbot với 2 model: Naive Bayes (phân loại topic) và KNN (tìm câu trả lời)",
    "data_source": "qa_valid.csv",
    "total_test_samples": 474
  },
  "preprocessing_pipeline": {
    "description": "Quy trình tiền xử lý văn bản tiếng Việt",
    "steps": [
      "1. Lowercase: Chuyển về chữ thường",
      "2. Special Char Removal: Xóa ký tự đặc biệt bằng Regex r\"[^\\w\\s]\"",
      "3. Number Removal: Xóa số bằng Regex r\"\\d+\"",
      "4. PyVi Tokenizer: Tách từ tiếng Việt (ViTokenizer.tokenize)",
      "5. Stopword Removal: Lọc các từ dừng tiếng Việt (52 từ)"
    ],
    "vectorization": {
      "method": "TF-IDF (Term Frequency - Inverse Document Frequency)",
      "params": {
        "max_features": 800,
        "ngram_range": "(1, 2) - unigram + bigram",
        "min_df": 1,
        "sublinear_tf": true,
        "formula": "TF-IDF(t,d) = (1 + log(tf)) × log(N/df)"
      }
    }
  },
  "models": {
    "naive_bayes": {
      "model": "Naive Bayes (Topic Classification)",
      "technique": {
        "algorithm": "Custom Multinomial Naive Bayes",
        "formula": "P(topic|X) ∝ P(topic) × ∏ P(word_i|topic)",
        "smoothing": "Laplace Smoothing (alpha=0.1)",
        "vectorizer": "TF-IDF (800 features, unigram+bigram, sublinear_tf=True)",
        "preprocessing": [
          "Lowercase",
          "Xóa ký tự đặc biệt & số",
          "PyVi Tokenizer (tách từ tiếng Việt)",
          "Lọc Vietnamese Stopwords"
        ]
      },
      "metrics": {
        "accuracy": 46.835443037974684,
        "average_confidence": 64.57782700421942,
        "expected_calibration_error": 25.73635021097047,
        "coverage_at_threshold": {
          "0.3": 99.15611814345992,
          "0.5": 58.22784810126582,
          "0.7": 45.358649789029535,
          "0.9": 9.915611814345992
        },
        "accuracy_at_threshold": {
          "0.3": 47.23404255319149,
          "0.5": 76.81159420289855,
          "0.7": 93.02325581395348,
          "0.9": 95.74468085106383
        },
        "total_samples": 474
      },
      "sample_results": [
        {
          "question": "Bạn hãy nêu Backpropagation tính toán gì trong mạn...",
          "true_topic": "DeepLearning",
          "predicted_topic": "DeepLearning",
          "confidence": 0.3931,
          "correct": true
        },
        {
          "question": "Bạn hãy cho biết Trong phân tích không gian của DF...",
          "true_topic": "Search",
          "predicted_topic": "Search",
          "confidence": 0.8175,
          "correct": true
        },
        {
          "question": "Bạn hãy cho biết IDS (Iterative Deepening Search) ...",
          "true_topic": "Search",
          "predicted_topic": "Search",
          "confidence": 0.9692,
          "correct": true
        },
        {
          "question": "Bạn hãy giải thích Trong phân tích không gian của ...",
          "true_topic": "Search",
          "predicted_topic": "Search",
          "confidence": 0.8175,
          "correct": true
        },
        {
          "question": "Bạn có thể cho biết Hãy viết phủ định tương đương ...",
          "true_topic": "LogicFOL",
          "predicted_topic": "Logic",
          "confidence": 0.517,
          "correct": false
        },
        {
          "question": "Bạn hãy giải thích Trong Iterative Deepening Searc...",
          "true_topic": "Search",
          "predicted_topic": "Search",
          "confidence": 0.9354,
          "correct": true
        },
        {
          "question": "Bạn có thể cho biết Trong A*, nếu một nút có chi p...",
          "true_topic": "SearchInformed",
          "predicted_topic": "Search",
          "confidence": 0.3884,
          "correct": false
        },
        {
          "question": "Bạn có thể cho biết Overfitting có thể phát hiện q...",
          "true_topic": "MachineLearning",
          "predicted_topic": "MachineLearning",
          "confidence": 0.3163,
          "correct": true
        },
        {
          "question": "Hãy trình bày Trong phân tích không gian của DFS, ...",
          "true_topic": "Search",
          "predicted_topic": "Search",
          "confidence": 0.8175,
          "correct": true
        },
        {
          "question": "Bạn hãy cho biết Giả sử cây tìm kiếm đều có hệ số ...",
          "true_topic": "Search",
          "predicted_topic": "Search",
          "confidence": 0.8393,
          "correct": true
        }
      ]
    },
    "knn": {
      "model": "KNN (Answer Retrieval)",
      "technique": {
        "algorithm": "Custom K-Nearest Neighbors",
        "distance_metric": "Cosine Distance = 1 - (A·B)/(||A||×||B||)",
        "confidence_formula": "Confidence = 1 - Cosine Distance = Cosine Similarity",
        "k_neighbors": 5,
        "vectorizer": "TF-IDF (800 features, unigram+bigram, sublinear_tf=True)",
        "preprocessing": [
          "Lowercase",
          "Xóa ký tự đặc biệt & số",
          "PyVi Tokenizer (tách từ tiếng Việt)",
          "Lọc Vietnamese Stopwords"
        ]
      },
      "metrics": {
        "exact_match_accuracy": 0.0,
        "average_confidence": 43.66947238152163,
        "coverage_at_threshold": {
          "0.3": 54.43037974683544,
          "0.5": 30.801687763713083,
          "0.7": 8.860759493670885,
          "0.9": 2.320675105485232
        },
        "accuracy_at_threshold": {
          "0.3": 0.0,
          "0.5": 0.0,
          "0.7": 0.0,
          "0.9": 0.0
        },
        "total_samples": 474
      },
      "sample_results": [
        {
          "question": "Bạn hãy nêu Backpropagation tính toán gì trong mạn...",
          "true_answer": "Tính gradient của hàm mất mát theo từng trọng số b...",
          "predicted_answer": "Là thuật toán tính gradient bằng chain rule để cập...",
          "matched_question": "backpropagation",
          "confidence": 0.7333447766035899,
          "exact_match": false,
          "cosine_distance": 0.2667
        },
        {
          "question": "Bạn hãy cho biết Trong phân tích không gian của DF...",
          "true_answer": "O(bm) cho biết bộ nhớ tỷ lệ với b·m. Với b=9, m=17...",
          "predicted_answer": "O(bm) với b là branching factor và m là độ sâu lớn...",
          "matched_question": "độ phức_tạp không_gian dfs",
          "confidence": 0.6692651214696691,
          "exact_match": false,
          "cosine_distance": 0.3307
        },
        {
          "question": "Bạn hãy cho biết IDS (Iterative Deepening Search) ...",
          "true_answer": "IDS có bộ nhớ như DFS nhưng tính hoàn chỉnh như BF...",
          "predicted_answer": "DFS (Depth-First Search) là thuật toán tìm kiếm th...",
          "matched_question": "dfs",
          "confidence": 0.609302969785935,
          "exact_match": false,
          "cosine_distance": 0.3907
        },
        {
          "question": "Bạn hãy giải thích Trong phân tích không gian của ...",
          "true_answer": "O(bm) cho biết bộ nhớ tỷ lệ với b·m. Với b=3, m=29...",
          "predicted_answer": "O(bm) với b là branching factor và m là độ sâu lớn...",
          "matched_question": "độ phức_tạp không_gian dfs",
          "confidence": 0.6692651214696691,
          "exact_match": false,
          "cosine_distance": 0.3307
        },
        {
          "question": "Bạn có thể cho biết Hãy viết phủ định tương đương ...",
          "true_answer": "Phủ định: ¬∃i∀jLikes(i,j) ≡ ∀i ∃j ¬Likes(i,j).",
          "predicted_answer": "P ↔ Q đúng khi P và Q có cùng giá trị chân lý.",
          "matched_question": "phép tương_đương",
          "confidence": 0.3471359775482946,
          "exact_match": false,
          "cosine_distance": 0.6529
        },
        {
          "question": "Bạn hãy giải thích Trong Iterative Deepening Searc...",
          "true_answer": "Tổng số nút ≈ ∑_{i=0..d} (d−i+1)·b^i. Với b=4, d=8...",
          "predicted_answer": "Là thuật toán tìm kiếm chỉ giữ trạng thái hiện tại...",
          "matched_question": "local search",
          "confidence": 0.21784362698293191,
          "exact_match": false,
          "cosine_distance": 0.7822
        },
        {
          "question": "Bạn có thể cho biết Trong A*, nếu một nút có chi p...",
          "true_answer": "f(n)=g(n)+h(n)=8+32=40.",
          "predicted_answer": "Là tổng chi phí của các hành động từ trạng thái gố...",
          "matched_question": "chi_phí đường",
          "confidence": 0.2644566102636957,
          "exact_match": false,
          "cosine_distance": 0.7355
        },
        {
          "question": "Bạn có thể cho biết Overfitting có thể phát hiện q...",
          "true_answer": "Lỗi huấn luyện thấp nhưng lỗi kiểm thử/validation ...",
          "predicted_answer": "Là hiện tượng mô hình học quá sát dữ liệu huấn luy...",
          "matched_question": "overfitting",
          "confidence": 0.5085423203783268,
          "exact_match": false,
          "cosine_distance": 0.4915
        },
        {
          "question": "Hãy trình bày Trong phân tích không gian của DFS, ...",
          "true_answer": "O(bm) cho biết bộ nhớ tỷ lệ với b·m. Với b=9, m=23...",
          "predicted_answer": "O(bm) với b là branching factor và m là độ sâu lớn...",
          "matched_question": "độ phức_tạp không_gian dfs",
          "confidence": 0.6692651214696691,
          "exact_match": false,
          "cosine_distance": 0.3307
        },
        {
          "question": "Bạn hãy cho biết Giả sử cây tìm kiếm đều có hệ số ...",
          "true_answer": "Số nút tối đa là 1 + 4 + 4^2 + … + 4^4 = (b^(d+1)−...",
          "predicted_answer": "O(b^d) với b là branching factor và d là độ sâu củ...",
          "matched_question": "độ phức_tạp thời_gian bfs",
          "confidence": 0.40256390267651865,
          "exact_match": false,
          "cosine_distance": 0.5974
        }
      ]
    }
  },
  "confidence_metrics_explanation": {
    "accuracy": "Tỷ lệ % dự đoán đúng",
    "average_confidence": "Giá trị confidence trung bình của model",
    "expected_calibration_error": "ECE - đo mức độ tin cậy của confidence (càng thấp càng tốt, <5% là tốt)",
    "coverage_at_threshold": "Tỷ lệ % mẫu có confidence >= threshold",
    "accuracy_at_threshold": "Accuracy chỉ tính trên các mẫu có confidence >= threshold"
  }
}